{% extends "linguistics/templates/base.html" %}

{% import 'linguistics/templates/macros.html' as templates_macros with context %}

{% block title %}Шаблон «{{template.key.text}}» |{{ super() }}{% endblock %}
{% block description %}Шаблон «{{template.key.text}}».{% endblock %}

{% block templates_content %}

{% if template.state.is_IN_GAME %}
<p class="alert alert-success pgf-template-in-game-message">Фраза находится в игре.</p>
{% endif %}

{% if template.state.is_ON_REVIEW %}
<p class="alert alert-warning pgf-template-on-review-message">Фраза находится на рассмотрении.</p>
{% endif %}

{% if template_child %}
<p class="alert alert-success pgf-has-child-message">Эта фраза имеет непроверенную <a href="{{url('linguistics:templates:show', template_child.id)}}">копию</a>.</p>
{% endif %}

{% if template_parent %}
<p class="alert alert-success pgf-has-parent-message">Эта фраза явлется копией <a href="{{url('linguistics:templates:show', template_parent.id)}}">другой фразы</a>.</p>
{% endif %}

{{ templates_macros.key_info(template.key)}}

<a href="{{url('linguistics:templates:', key=template.key.value)}}">◀ вернуться к списку шаблонов</a>

<br/>
<br/>

<h4>Шаблон</h4>

<p style="margin: 1em; margin-top: 0.25em;">
  {{template.raw_template}}
</p>

{% if errors %}
<h4>Ошибки</h4>

{% for error in errors %}
<p class="alert alert-danger pgf-verificator-error-message">{{error}}</p>
{% endfor %}

{% endif %}



{% for verificator in template.verificators %}
<h4>{{verificator.get_label()}}</h4>
<p style="margin: 1em; margin-top: 0.25em;">
  {{verificator.text}}
</p>
{% endfor %}

<a class="btn btn-success" href="{{url('linguistics:templates:edit', template.id)}}">Редактировать</a>

{% if resource.can_moderate_templates %}

{% if template_parent %}
<a class="btn btn-info pgf-forms-post-simple pgf-replace-button"
   href="{{url('linguistics:templates:replace', template.id)}}">Заменить родителя</a>

<a class="btn btn-info pgf-forms-post-simple pgf-detach-button"
   href="{{url('linguistics:templates:detach', template.id)}}">Отцепить от родителя</a>
{% endif %}

{% if template.state.is_ON_REVIEW %}
<a class="btn btn-success pgf-forms-post-simple pgf-in-game-button"
   href="{{url('linguistics:templates:in-game', template.id)}}">В игру</a>
{% endif %}

{% if template.state.is_IN_GAME %}
<a class="btn btn-warning pgf-forms-post-simple pgf-on-review-button"
   href="{{url('linguistics:templates:on-review', template.id)}}">Из игры</a>
{% endif %}

<a class="btn btn-danger pgf-forms-post-simple pgf-remove-button"
   href="{{url('linguistics:templates:remove', template.id)}}"
   data-action-type="redirect"
   data-redirect-url="{{url('linguistics:templates:')}}">Удалить</a>
{% endif %}


{% endblock %}
