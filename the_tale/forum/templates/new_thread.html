{% extends "forum/base.html" %}

{% block head %}
{{ super() }}
<script src="{{ STATIC_URL }}forum/base.js" type="text/javascript"></script>
<script type="text/javascript">
jQuery(document).ready( function(e) {

    var newThreadForm = new pgf.forms.Form(jQuery('#pgf-new-thread-form'),
                                           { OnSuccess: function(form, data){
                                               var url = "{{ url('forum:subcategory', subcategory.slug) }}";
                                               location.href = url + '/' + data.data.thread_id;
                                           }
                                           });
    pgf.base.AddPreview('#pgf-new-thread-form', 'textarea', "{{ url('forum:preview') }}");

    pgf.forum.InitPostFields();
});

</script>

{% endblock %}


{% block forum_content %}

<ul class="breadcrumb">
  <li><a href="{{ url('forum:') }}">Форум</a><span class="divider">/</span></li>
  <li><a href="{{ url('forum:subcategory', subcategory.slug) }}">{{ subcategory.caption }}</a><span class="divider">/</span></li>
  <li class="active">новая тема</li>
</ul>

<form id="pgf-new-thread-form" method="post" action="{{ url('forum:create-thread', subcategory.slug) }}" class="new-post-form">

  {{ new_thread_form.errors_container }}

  <div class="post-content">
    {{ new_thread_form.caption.widget}}
  </div>

  <div class="pgf-edit-content">
    {{ new_thread_form.text.widget }}
  </div>
  <div class="pgf-preview-content pgf-hidden">
  </div>

  <div class="widget">
    <input type="submit" value="Создать"/>
    <input type="button" class="pgf-preview-button" value="Предпросмотр"/>
    <input type="button" class="pgf-edit-button pgf-hidden" value="Редактировать"/>
  </div>

</form>

{% endblock %}
