{% extends "forum/base.html" %}

{% block head %}
{{ super() }}
<script type="text/javascript">
jQuery(document).ready( function(e) {

    var newThreadForm = new pgf.forms.Form(jQuery('#pgf-new-thread-form'),
                                           { OnSuccess: function(form, data){
                                               var url = "{{ url('forum:subcategory', category.slug, subcategory.slug) }}";
                                               location.href = url + '/' + data.data.thread_id;
                                           }
                                           });
    pgf.base.AddPreview('#pgf-new-thread-form', 'textarea', "{{ url('forum:preview') }}");
});

</script>

{% endblock %}


{% block forum_content %}

<h1>{{ category.caption }}::{{ subcategory.caption }}</h1>

<form id="pgf-new-thread-form" method="post" action="{{ url('forum:create_thread', category.slug, subcategory.slug) }}" class="block long">

  {{ new_thread_form.errors_container }}
  {{ new_thread_form.caption.widget}}

  <div class="pgf-edit-content">
    {{ new_thread_form.text.widget }}
  </div>
  <div class="pgf-preview-content pgf-hidden block">
  </div>

  <div class="widget">
    <input type="submit" value="Создать"/>
    <input type="button" class="pgf-preview-button" value="Предпросмотр"/>
    <input type="button" class="pgf-edit-button pgf-hidden" value="Предпросмотр"/>
  </div>

</form>

{% endblock %}
