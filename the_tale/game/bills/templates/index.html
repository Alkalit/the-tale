{% extends "bills/base.html" %}

{% import 'macros.html' as base_macros with context %}
{% import 'bills/macros.html' as bills_macros with context %}
{% import 'utils/list_filter.html' as list_filter_macros with context %}

{% block title %}{{ super() }}{% endblock %}
{% block description %}Выдвинутые игроками законы.{% endblock %}

{% block bills_content %}

{% if not resource.account.is_authenticated() %}

<p class="alert alert-info pgf-unlogined-message">
  Вам необходимо <a href="{{login_url(resource.request.get_full_path())}}">войти</a> или <a href="{{ url('accounts:registration:fast') }}" class="pgf-fast-registration attention-link">создать героя</a>, чтобы иметь возможность предлагать законы и голосовать.
</p>

{% elif active_bills_limit_reached %}

<p class="alert alert-info pgf-active-bills-limit-reached">
  Вы не можете предложить закон, пока не закончилось голосование по вашему предыдущему предложению.
</p>

{% elif not resource.can_participate_in_politics %}

<p class="alert alert-info pgf-can-not-participate-in-politics">
  Предлагать законы только игроки, завершившие регистрацию.
</p>

{% else %}

<div class="btn-group pgf-create-new-bill-buttons pull-left"
     style="display: inline-block; vertical-align: middle; margin-right: 0.5em; margin-bottom: 0.5em;">
  <a class="btn btn-danger btn-primary dropdown-toggle" data-toggle="dropdown">
    Предложить закон <span class="caret"></span>
  </a>
  <ul class="dropdown-menu">
    {% for bill_id, bill_type in BILLS_BY_ID.items() %}
    <li><a href="{{ url('game:bills:new', bill_type=bill_id) }}">{{bill_type.CAPTION}}</a></li>
    {% endfor %}
  </ul>
</div>

{% endif %}

<p>
  Жизнью Пандоры управляют игроки. В этом разделе Вы можете напрямую принять участие в управлении миром, жизни его городов и их жителей. Подробнее о системе политики можно почитать в <a href="{{url('guide:politics')}}">Путеводителе</a>.
</p>

<h2 style="margin-bottom: 0.5em;">Список законов</h2>

{{ list_filter_macros.html_filter(index_filter) }}

{% if bills %}

{{ base_macros.render_paginator(paginator) }}

<ul class="unstyled">
  {% for bill in bills %}
  <li style="margin-bottom: 1em;">
    {{ bills_macros.bill_record(bill, votes.get(bill.id)) }}
  </li>
  {% endfor %}
</ul>

{{ base_macros.render_paginator(paginator) }}

{% else %}
<span class="pgf-no-bills-message">Не найдено законопроектов, отвечающих условиям поиска</span>
{% endif %}

{% endblock %}
