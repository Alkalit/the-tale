{% extends "bills/base.html" %}

{% import 'macros.html' as base_macros with context %}
{% import 'bills/macros.html' as bills_macros with context %}

{% block bills_content %}

<p>
  <div class="btn-group" style="display: inline-block; vertical-align: middle;">
    <a class="btn btn-danger btn-primary dropdown-toggle" data-toggle="dropdown">
      Предложить закон <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
      {% for bill_id, bill_type in BILLS_BY_ID.items() %}
      <li><a href="{{ url('game:bills:new', bill_type=bill_id) }}">{{bill_type.CAPTION}}</a></li>
      {% endfor %}
    </ul>
  </div>

  Жизнью Пандоры управляют игроки. В этом разделе Вы можете напрямую принять участие в управлении миром, жизни его городов и персонажей.
</p>

<h2 style="margin-bottom: 0.5em;">список законов</h2>

<div>
  <div class="btn-toolbar">

    <div class="btn-group">
      <a class="btn {% if not is_filtering %}disabled{% endif %}"
         href="{% if is_filtering %}{{ url('game:bills:') }}{%else%}javascript: return none;{%endif%}">сбросить фильтрацию</a>
    </div>

    {% if owner_account %}
    <div class="btn-group">
      <a class="btn disabled" href="#">автор: {{owner_account.nick}}</a>
    </div>
    {% endif %}

    <div class="btn-group">
      <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        состояние:
        {% if state.is_voting %} голосование
        {% elif state.is_accepted %} принятые
        {% elif state.is_rejected %} отклонённые
        {% else %} все
        {% endif %}
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="{{ url_builder(state=none) }}">все</a></li>
        <li><a href="{{ url_builder(state=BILL_STATE.VOTING) }}">голосование</a></li>
        <li><a href="{{ url_builder(state=BILL_STATE.ACCEPTED) }}">принятые</a></li>
        <li><a href="{{ url_builder(state=BILL_STATE.REJECTED) }}">отклонённые</a></li>
      </ul>
    </div>

    <div class="btn-group">
      <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        голосование:
        {% if voted is not none %} {{ voted.verbose }}
        {% else %} все
        {% endif %}
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="{{ url_builder(voted=none) }}">все</a></li>
        {% for voted_id, voted_text in VOTED_TYPE._ID_TO_TEXT.items() %}
        <li><a href="{{ url_builder(voted=voted_id) }}">{{voted_text}}</a></li>
        {% endfor %}
      </ul>
    </div>

    <div class="btn-group">
      <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        тип:
        {% if bill_type is not none %} {{bill_type.verbose}}
        {% else %} все
        {% endif %}
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="{{ url_builder(bill_type=none) }}">все</a></li>
        {% for bill_id, bill_type_ in BILLS_BY_ID.items() %}
        <li><a href="{{ url_builder(bill_type=bill_type_.type) }}">{{bill_type_.CAPTION}}</a></li>
        {% endfor %}
      </ul>
    </div>

  </div>

</div>

{% if bills %}

{{ base_macros.render_paginator(paginator) }}

<ul class="unstyled">
  {% for bill in bills %}
  <li style="margin-bottom: 1em;">
    {{ bills_macros.bill_record(bill, votes.get(bill.id)) }}
  </li>
  {% endfor %}
</ul>

{{ base_macros.render_paginator(paginator) }}

{% else %}
<span class="pgf-no-bills-message">Не найдено законопроектов, отвечающих условиям поиска</span>
{% endif %}

{% endblock %}
