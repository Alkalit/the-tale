{% extends "guide/base.html" %}
{% import 'guide/macros.html' as guide_macros with context %}
{% import 'utils/list_filter.html' as list_filter_macros with context %}

{% block title %}Спутники | {{ super() }}{% endblock %}
{% block description %}Описание всех спутников, которые могут присоединиться к герою в его путешествиях.{% endblock %}

{% block guide_content %}

{{ guide_macros.page_caption("Спутники", "Описание всех спутников, которые могут присоединиться к герою в его путешествиях.") }}

<p>
  По трактам Пандоры путешествуют не только герои. На них можно встретить множество обычных (и необычных) странников. Они преследуют разные цели, но всем ясно одно — рядом с героем безопаснее, или веселее, или полезнее. Поэтому со временем у каждого героя появляется свой спутник, будь то дворовый пёс, странствующий сказитель, наёмник, учёный или даже сама Костлявая.
</p>

<div class="accordion" id="pgf-companion-effects-accordion">

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#pgf-companion-effects-accordion" href="#pgf-effects">
        Список особенностей спутников
      </a>
    </div>
    <div id="pgf-effects" class="accordion-body collapse" style="height: 0px;">
      <div class="accordion-inner">
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>название</th>
              <th>описание</th>
            </tr>
          </thead>
          <tbody>
            {% for ability in ABILITIES.records|sort(attribute="text") %}
              <tr>
                <td>{{ability.text}}</td>
                <td>{{ability.description}}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>


      </div>
    </div>
  </div>

</div>


{% if context.companions_can_edit %}
<a class="btn btn-danger pgf-create-companion-button" href="{{url('game:companions:new')}}">создать спутника</a>
{% endif %}

{{ list_filter_macros.html_filter(index_filter) }}

{% if companions %}

<table class="table table-condensed">
  <thead>
    <tr>
      <th width="10px"></th>
      <th>название</th>
      <th>тип</th>
      <th>архетип</th>
      <th>самоотверженность</th>
      <th>здоровье</th>
      <th>способности</th>
    </tr>
  </thead>
  <tbody>
    {% for companion in companions %}
    <tr>
      <td>
        <div class="{{companion.rarity.name|lower}}-card-bg"
             style="height: 10px; width: 10px; margin-top: 5px; cursor: pointer;"
             rel="tooltip"
             title="{{companion.rarity.text}}"></div>
      </td>

      <td><a href="{{url('guide:companions:show', companion.id)}}">{{companion.name}}</a></td>
      <td>{{companion.type.text}}</td>
      <td>{{companion.archetype.text}}</td>
      <td>{{companion.dedication.text}}</td>
      <td>{{companion.max_health}}</td>
      <td>
        <a class="info-link"
           href="#"
           onclick="return false;"
           rel="tooltip"
           title="<ul class='unstyled' style='text-align: left;'>
                  {%- for coherence, ability in companion.abilities.all_abilities -%}
                  <li>согласованность {{coherence}}: {{ability.text}}</li>
                  {%- endfor -%}
                  </ul>">
          способности
        </a>
      </td>
    {% endfor %}
  </tbody>
</table>

{% else %}
<p class="pgf-no-companions-message alert alert-info">Не найдено спутников, отвечающих условиям поиска.</p>
{% endif %}

{% endblock %}
