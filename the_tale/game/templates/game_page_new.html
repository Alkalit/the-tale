{% extends "base.html" %}

{% block head %}
{{ super() }}

<script src="{{ STATIC_URL }}game/widgets.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}game/map/map2.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}game/map/sprites.js" type="text/javascript"></script>

<script type="text/javascript">

var updater = undefined;
var widgets = {};

jQuery(document).ready(function(e){

    updater = new pgf.game.Updater({url: "{{ url('game:info') }}?angel={{ angel_id }}"});

    widgets.switcher = new pgf.game.widgets.WidgetSwitcher();

    jQuery('.pgf-next-turn').click(function(e){
        e.preventDefault();

        pgf.forms.Post({ action: "{{ url('game:turns:next_turn') }}",
                         OnSuccess: function(e){
                             updater.Refresh();
                         }
                       });
    });

    setTimeout(function(){
        updater.Refresh();
    }, 0);
});

</script>
{% endblock %}

{% block debug_menu %}
{{ super() }}
<li><a href="#" class="pgf-next-turn">next turn</a></li>
{% endblock %}


{% block content %}

<div id="left-column" class="column">
  {% include "game/hero.html" %}
  {% include "game/hero-equipment.html" %}
  {% include "game/hero-bag.html" %}
</div>

<div id="center-column" class="column">
  {% include "game/world-place-time.html" %}
  {% include "game/current-actions.html" %}
  {% include "game/log.html" %}
  {% include "game/activate_card.html" %}
  {% include "game/map.html" %}
</div>

<div id="right-column" class="column">
  {% include "game/angel.html" %}
  {% include "game/cards.html" %}
</div>

<div class="pgf-hidden" id="pgf-item-tooltip-template">
  <h6 class="pgf-name"></h6>
  <span class="pgf-type"></span><span class="pgf-subtype-enabled pgf-hidden"> - <span class="pgf-subtype"></span></span>
    
  <ul>
    <li class="pgf-effect-weapon-base pgf-hidden">
      урон: <span class="pgf-raw-effect-min_damage"></span> - <span class="pgf-raw-effect-max_damage"></span>
    </li>
    <li class="pgf-effect-weapon-base pgf-hidden">скорость в бою: <span class="pgf-raw-effect-battle_speed"></li>
  </ul>
</div>

{% endblock %}
