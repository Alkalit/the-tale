{% extends "base.html" %}

{% import 'news/macros.html' as news_macros with context %}

{% block title %}{{ super() }}{% endblock %}

{% block content %}

{% if not resource.account %}
<div class="row">
  <div class="span12">
    <div class="block">
      <a class="btn btn-danger pgf-fast-registration"
         href="{{ url('accounts:registration:fast') }}"
         style="width: 170px; height: 64px; font-size: 19pt; float: left; margin-right: 0.5em; margin-top: 0.3em;">
        <span style="position: relative; top: 20px;">Создать героя</span>
      </a>

      <h2>Здравствуйте!</h2>

      <p>
        Добро пожаловать в Сказку — многопользовательскую ролевую игру с непрямым управлением персонажами и изменяемым окружением.
      </p>
      <p>
        Наша цель — сплести вокруг каждого игрока клубок волшебных историй и, объединив их, создать настоящий живой мир.
      </p>
      <p>
        На текущий момент мы находимся в альфе, но уже можно пощупать основные фишки игры. Итак, Сказка — это:
      </p>

      <dl>

        <div class="dl-record">
          <dt>Живой мир</dt>
          <dd>Мир игры в состоянии жить без какого-либо вмешательства игроков — жизнь в нём никогда не замирает. Его жители конкурируют за влияние, меняются очертания лесов, пустынь, лесов и болот. Растут и угасают города, творится история. Задача игроков — направить историю туда, куда они хотят.</dd>
        </div>

        <div class="dl-record">
          <dt>Живая история</dt>
          <dd>Забудьте о линейных однообразных квестах. У нас историю делаете Вы. Все задания, которые получают герои, привязаны к текущей ситуации в мире, предоставляют возможность выбора и оказывают существенное влияние на развитие сюжета. Хотите, что бы город перешёл во владение орков? — Помогайте им или мешайте всем остальным.</dd>
        </div>

        <div class="dl-record">
          <dt>Живые герои</dt>
          <dd>Герои нашей Сказки — не бездушные марионетки. Они обладают волей и в состоянии действовать без Вашей помощи. Вы же можете помогать им и подталкивать к нужным решениям. </dd>
        </div>

      </dl>

      <p>
        Хотите узнать больше? — <a href="{{ url('guide:') }}">Путеводитель по Сказке</a> к Вашим услугам.
      </p>

    </div>
  </div>
</div>

{% endif %}

<div class="row">
  <div class="span3" style="min-height: 50px;">&nbsp;</div>
  <div class="span6" style="text-align: center; min-height: 50px;">
    <h1 style="font-size: 40px; line-height: 50px;">Вестник Пандоры</h1>
  </div>
  <div class="span3" style="vertical-align: middle; min-height: 50px;">
    <h4 style="line-height: 50px;">Выпуск №{{get_edition_number()}}</h4>
  </div>
</div>

<div class="row">

  <div class="span3">
    <div class="block">
      <h4 class="newspaper-column-header">Герой дня</h4>
      {% if hero_of_the_day %}
      {% include hero_of_the_day.data.TEMPLATE with context %}
      {% else %}
      Здесь может быть Ваша реклама.
      {% endif %}
    </div>

    <div class="block">
      <h4 class="newspaper-column-header">Горячие темы</h4>
      <ul class="unstyled">
        {% for thread in forum_threads %}
        <li class="newspaper-link-list">
          <span class="pgf-format-time newspaper-link-time" data-timestamp="{{ thread.updated_at|timestamp }}"></span>
          <span class="newspaper-forum-user">{{thread.last_poster.nick}}</span>
          <br/>
          {{ thread.caption }}&nbsp;<a style="font-size: 10pt;" href="{{ thread.paginator.last_page_url }}">➔</a>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="span6">
    <div class="row">
      <div class="span6">
        <div class="block">

          <h4 class="newspaper-column-header">
            Новости
            <a href="{{ get_rss_link() }}" class="rss-link" rel="alternate" type="application/rss+xml" rel="tooltip" title="подписаться на rss">
              <img src="{{STATIC_URL}}images/rss.png" style="margin: 2px;"/>
            </a>
            <small><a href="{{ url('news:') }}">ещё…</a></small>
          </h4>

          <ul class="unstyled">
            {% for record in news %}
            {{ news_macros.news_record(record) }}
            {% endfor %}
          </ul>
        </div>

      </div>
    </div>

    <div class="row">

      <div class="span3">
        <div class="block">
          <h4 class="newspaper-column-header">Географический уголок</h4>
          <span style="font-size: 8pt;">от Гоблинского Географического Общества.</span>

          <table class="table table-condensed">
            <tr><th>местность</th>  <th>распространение<th></tr>
            <tr><th>равнины</th>    <td>{{ map_info.terrain_percents.get(TERRAIN.GRASS, 0)|percents }}</td></tr>
            <tr><th>болота</th>     <td>{{ map_info.terrain_percents.get(TERRAIN.SWAMP, 0)|percents }}</td></tr>
            <tr><th>леса</th>       <td>{{ map_info.terrain_percents.get(TERRAIN.FOREST, 0)|percents }}</td></tr>
            <tr><th>пустыни</th>    <td>{{ map_info.terrain_percents.get(TERRAIN.DESERT, 0)|percents }}</td></tr>
            <tr><th>горы</th>       <td>{{ map_info.terrain_percents.get(TERRAIN.MOUNTAINS, 0)|percents }}</td></tr>
          </table>

        </div>
      </div>

      <div class="span3">
        <div class="block">
          <h4 class="newspaper-column-header">Политический обзор</h4>
          <span style="font-size: 8pt;">от ПандораСтат</span>
          <table class="table table-condensed">
            <tr><th>раса</th>   <th>влияние<th><th>города</th></tr>
            <tr><th>люди</th>   <td>{{ map_info.race_percents.get(RACE.HUMAN, 0)|percents }}<td> <td>{{ map_info.race_cities.get(RACE.HUMAN, 0) }}</td></tr>
            <tr><th>гоблины</th><td>{{ map_info.race_percents.get(RACE.GOBLIN, 0)|percents }}<td><td>{{ map_info.race_cities.get(RACE.GOBLIN, 0) }}</td></tr>
            <tr><th>эльфы</th>  <td>{{ map_info.race_percents.get(RACE.ELF, 0)|percents }}<td>   <td>{{ map_info.race_cities.get(RACE.ELF, 0) }}</td></tr>
            <tr><th>орки</th>   <td>{{ map_info.race_percents.get(RACE.ORC, 0)|percents }}<td>   <td>{{ map_info.race_cities.get(RACE.ORC, 0) }}</td></tr>
            <tr><th>дварфы</th> <td>{{ map_info.race_percents.get(RACE.DWARF, 0)|percents }}<td> <td>{{ map_info.race_cities.get(RACE.DWARF, 0) }}</td></tr>
          </table>
        </div>
      </div>

    </div>

  </div>

  <div class="span3">

    <div class="block">
      <h4 class="newspaper-column-header">Законотворчество</h4>

      <ul class="unstyled">
        {% for bill_event in bills_events %}
        <li class="newspaper-link-list">
          <span class="pgf-format-datetime newspaper-link-time" data-timestamp="{{ bill_event.created_at|timestamp }}"></span><br/>
          {% include bill_event.data.TEMPLATE with context %}
        </li>
        {% endfor %}
      </ul>
    </div>

  </div>

</div>

{% endblock %}
